{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "OAGW Guard Plugin",
  "type": "object",
  "properties": {
    "id": {
      "type": "string",
      "format": "gts-identifier",
      "examples": [
        "gts.x.core.oagw.guard_plugin.v1~x.core.oagw.timeout.v1",
        "gts.x.core.oagw.guard_plugin.v1~acme.security.oagw.request_validator.v1"
      ]
    },
    "type": {
      "type": "string",
      "format": "gts-identifier",
      "enum": [
        "gts.x.core.oagw.plugin_type.v1~x.core.oagw.builtin.v1",
        "gts.x.core.oagw.plugin_type.v1~x.core.oagw.starlark.v1"
      ]
    },
    "config_schema": {
      "type": "object",
      "description": "JSON Schema validated when plugin is attached to upstream/route."
    },
    "source_ref": {
      "type": "string",
      "format": "uri",
      "pattern": "^/api/oagw/v1/plugins/.+/source$",
      "description": "Derived from plugin id. Starlark source fetched via GET {source_ref}."
    }
  },
  "required": [ "id", "type", "config_schema" ]
}
